---
name: Lint OpenAPI Descriptions

on:
  - push

jobs:
  build:
    strategy:
      matrix:
        include:
          - version: 3.0
            files: 'descriptions/**/*.yaml'
    name: Lint OpenAPI Descriptions (${{matrix.version}})
    runs-on: ubuntu-latest
    steps:
      - name: Checkout Code
        uses: actions/checkout@v2
        with:
          fetch-depth: 0
      - name: Yaml Lint
        uses: karancode/yamllint-github-action@v2.0.0
        with:
          yamllint_file_or_dir: ${{matrix.files}}
          yamllint_strict: false
          yamllint_config_filepath: '.yamllint-config.yml'
          yamllint_comment: true
      - uses: actions/setup-node@v3
        with:
          node-version: '16'
      - run: npm install
      - name: JSON Lint
        run: npm run lint
      - name: OpenAPI Lint
        uses: mattpage/redocly-cli-lint-action@v0.0.1
        with:
          entrypoints: ${{matrix.files}}
          config: '.redocly.yml'
